# Стажировка VK. Чат-бот для знакомств

## Содержание

- [Задание](#задание)
  - [Требования](#требования)
    - [Общие требования](#общие-требования)
    - [Технические требования](#технические-требования)
- [Реализация](#реализация)
  - [Структура проекта](#структура-проекта)

## Задание

Создать простого чат-бота на базе [ВКонакте API](https://dev.vk.com/reference).

### Требования

#### Общие требования

Бот должен уметь:

- отправлять приветственное сообщение;
- иметь минимум 4 кнопки на первом слое и минимум по 2 во втором.

#### Технические требования

Бота необходимо реализовать на языке [Go](https://go.dev/) с минимальным использованием готовых пакетов.

### Реализация

Я решил написать чат-бота для знакомств.

![](images/bot.jpg)

Проект написан с применением [Clean Architecture](https://github.com/evrone/go-clean-template), соблюдая принципы 
[Standard Go Project Layout](https://github.com/golang-standards/project-layout).

Для хранения информации о пользователях бота используется **PostgreSQL**. Также реализована *система вопросов* (система,
запоминающая тип последнего взаимодейстия конкретного пользователя с чат-ботом) на **Redis**.

Благодаря тому, что используется чистая архитектура, переход на другие базы данных становится
легкоосуществимым, поскольку бизнес-логика не зависит от логики работы с базой данных — инверсия зависимостей. По этим 
же причинам переход, например, на [Telegram API](https://core.telegram.org/api) не потребует больших усилий.

Для запуска проекта используется **Docker** + **Docker Compose**. Таким образом, вручную разворачивать базы данных на
хост-машине не нужно.

#### Структура проекта

```go
cmd
└── app
    └── main.go <- Точка входа в приложение
internal
├── app
│   └── app.go <- Инициализирующий код
├── config
│   ├── config.go <- Код парсинга конфигурации (YAML-файл или переменные окружения)
│   └── config.yml <- Пример YAML-конфигурации
├── entities
│   └── ... <- Сущности для баз данных
├── models
│   └── ... <- Модели для использования непосредственно в бизнес-логике
├── handlers
│   ├── payloadHandlers
│   │   └── ... <- Обработчики полезной нагрузки с клавиатуры бота
│   ├── questionsHandlers
│   │   └── ... <- Обработчики вопросов
│   └── registry.go <- Код регистрации обработчиков
├── migrations
│   └── ... <- Файлы миграций
└── usecase
├── repo
│   └── ... <- Реализации интерфейсов репозиториев
├── interfaces.go <- Интерфейсы юзкейсов и репозиториев
└── ... <- Реализации интерфейсов юзкейсов
pkg <- Общий код
├── logger
│   └── ... <- Код логгера
├── postgres
│   └── ... <- Код для взаимодействия с PostgreSQL
└── vkapi
└── ... <- Код для взаимодействия с ВКонтакте API
Dockerfile
docker-compose.yml
Makefile
.env <- Переменные окружения для Docker Compose
```
